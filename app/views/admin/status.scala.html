@(status: SystemStatus)(implicit session: Session, flash: Flash)

@layout.bootstrap("Server Status") {
  <div style="text-align: right;">
    <a style="margin: 10px 0 10px 0;" href="@routes.AdminController.observeRandomGame()" target="_blank" class="btn btn-default">Observe Random Game</a>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-body">
          <h5>@status.connections.size Connections</h5>
          <div style="height: 200px; overflow: auto;">
            <table class="table table-bordered">
              <tr>
                <th>Connection ID</th>
                <th>Username</th>
                <th></th>
              </tr>
              @for(connection <- status.connections) {
                <tr>
                  <td>
                    <a href="@routes.AdminController.traceConnection(connection._1)" onclick="trace(this.href);return false;">@connection._1</a>
                  </td>
                  <td>@connection._2</td>
                  <td>
                    <a href="@routes.AdminController.traceClient(connection._1)" onclick="trace(this.href);return false;"><span class="glyphicon glyphicon-cloud-download"></span></a>
                  </td>
                </tr>
              }
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-body">
          <h5>@status.games.size Games</h5>
          <div style="height: 200px; overflow: auto;">
            <table class="table table-bordered">
              <tr>
                <th>Game ID</th>
                <th>Players</th>
              </tr>
              @for(game <- status.games) {
                <tr>
                  <td>
                    <a href="@routes.AdminController.traceGame(game._1)" onclick="trace(this.href);return false;">@game._1</a>
                  </td>
                  <td>@game._2.map(_._2).mkString(", ")</td>
                </tr>
              }
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-body">
          <div id="trace-content">
            Select an option from above.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function trace(url) {
      $("#trace-content" ).load(url);
    }
  </script>
}
